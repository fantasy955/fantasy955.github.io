## 关键渲染路径

关键渲染路径就是浏览器HTML、CSS、JavaScript渲染为用户可以看见的界面的过程。

首先需要将HTML解析为DOM树，在解析的过程中会越到一些阻塞的情况，例如去请求和执行js脚本，以及将CSS解析为CSSOM树。**CSS 是渲染阻塞的**：浏览器会阻塞页面渲染直到它接收和执行了所有的 CSS。**CSS 是渲染阻塞是因为规则可以被覆盖**（而DOM是增量的，不会覆盖之前的内容），所以内容不能被渲染直到 CSSOM 的完成。构建 `DOM树` 和 构建 `CSSOM树` 是并行的。

CSSOM（CSS对象模型）与DOM结合生成渲染树，之后计算元素的**位置和大小**，这个阶段称为Layout，回流就是再次执行这个阶段。

在Painting阶段将每个节点的像素画到页面上，重绘是再次执行这个阶段。

### 性能优化

- 减少调用dom.offsetWidth的次数，因此浏览器会执行回流保证得到正确的宽度；
- 如果需要添加多个元素，可以先将元素添加到Fragment中，再添加到DOM中，或者使用`display:none`隐藏父级元素；
- 使用cssText或者className一次性改变样式；

### 参考资料

- [前端性能指标和优化目标——布局(layout) 与绘制(paint)_背太阳的牧羊人的博客-CSDN博客_布局和绘制](https://blog.csdn.net/u013565133/article/details/114406815)

---

## async和defer

`async` 和 `defer` 都仅对外部脚本有效；`async` 标志的脚本文件一旦`加载完成就立即执行`；而 `defer` 标志的脚本文件会在 **HTML解析完成**且**DOM构建完毕**后再执行；（也就是说`defer`是延迟执行，`async`是异步执行）；如果同时使用`async`和`defer`属性，`defer`不起作用，浏览器行为由`async`属性决定。`DOMContentLoaded` 事件会**等待** `defer` 的脚本执行完后才触发。

---

## 缓存

`Cache-Control` 是一个 HTTP 响应头，用于控制缓存的行为。您可以在**服务器端**设置 `Cache-Control` 响应头，以指定客户端（例如浏览器）如何缓存响应的内容。

`Cache-Control` 响应头的值是一个或多个逗号分隔的指令。每个指令都用于指定一种缓存行为。例如，您可以使用 `max-age` 指令来指定缓存副本的最大有效时间，或使用 `no-cache` 指令来要求客户端在使用缓存副本之前进行验证。

`no-cache` 和 `no-store` 都是 HTTP 响应头中 `Cache-Control` 指令的值，用于控制缓存的行为。它们的主要区别在于是否允许缓存副本。

- `no-cache` 指令表示客户端（例如浏览器）可以缓存响应的副本，但在使用缓存副本之前必须向服务器进行验证。这意味着，当客户端需要再次获取相同的资源时，它会先向服务器发送一个请求，询问缓存副本是否仍然有效。如果服务器回复缓存副本仍然有效，那么客户端可以使用缓存副本；否则，客户端需要重新获取资源。
- `no-store` 指令表示客户端不得以任何形式缓存响应的副本。这意味着，当客户端需要再次获取相同的资源时，它必须向服务器发送一个新的请求，而不能使用缓存副本。

## 从输入网址到渲染，经历了哪些流程

1. DNS域名解析
2. 客户端向服务器发起HTTPS请求，连接到服务器的443端口。
3. 服务器将自己的证书（包含公钥）发送给客户端。
4. 客户端验证证书的合法性，如果证书不合法，连接将被关闭。
5. 客户端生成一个随机数，用服务器的公钥加密后发送给服务器。
6. 服务器使用自己的私钥解密客户端发来的随机数，并使用该随机数生成对称密钥。
7. 服务器将对称密钥加密后发送给客户端。

---

1. 客户端使用对称密钥加密HTTP请求内容并发送给服务器。
2. 服务器使用对称密钥解密HTTP请求内容并处理请求。
3. 服务器将HTTP响应内容使用对称密钥加密后发送给客户端。
4. 客户端使用对称密钥解密HTTP响应内容并渲染页面。

使用HTTPS协议的话，会在HTTP流程前加上证书验证和密钥交换的过程，之后HTTP传输的数据都是加密传输的。包括起始行、首部、实体都是加密的。

## HTTP请求

### 请求体类型

**form-data**： 就是form表单中的multipart/form-data，会**将表单数据处理为一条信息**，用特定标签符将一条条信息分割开，而这个文件类型通常用来上传二进制文件。

**x-www-form-urlencoded**：就是application/x-www-form-urlencoded，**是form表单默认的encType**，form表单会将表**单内的数据转换为键值对**，这种格式不能上传文件。

**raw**：可以上传**任意格式的文本**，可以上传Text，JSON，XML等，但目前大部分还是上传JSON格式数据。当后端需要接收JSON格式数据处理的时候，可以采用这种格式来测试。
