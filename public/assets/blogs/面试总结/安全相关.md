## XSS攻击

XSS攻击，即跨站脚本攻击，是一种在web应用中的计算机安全漏洞，它允许恶意web用户将代码植入到提供给其它用户使用的页面中。XSS攻击的本质是利用了**web应用对用户输入的信任**，从而绕过了浏览器的同源策略，执行了非法的脚本。

XSS攻击的危害是：

- 可以盗取用户的cookie，从而获取用户的身份信息，进行身份冒充或者其他恶意操作。
- 可以执行恶意代码，从而对用户的计算机或者网络造成破坏，例如弹出广告、下载木马、修改浏览器设置等。
- 可以破坏页面结构，从而影响用户的正常浏览，例如插入恶意内容、修改页面样式、隐藏页面元素等。
- 可以重定向到其他网站，从而诱导用户进入钓鱼网站或者其他恶意网站，例如伪造登录页面、诱导用户输入敏感信息等。

攻击方式：

- 构造包含恶意js代码的url并诱导用户点击（反射型XSS攻击）；
- DOM-based攻击，同样是通过构造恶意url，当目的是改变用户的DOM结构，

## CSRF攻击

CSRF（**Cross**-site request forgery）的中文名称跨站请求伪造，也被称为“**One** Click Attack”或者 Session Riding，通常缩写为 CSRF 或者 XSRF，是一种对网站的恶意利用。CSRF 则通过伪装成受信任用户的请求来利用受信任的网站，攻击者获取了用户的凭证，例如cookie或者token，主动向服务端发送请求，服务端接收到用户凭证后就认为这是一个正常的用户请求，执行这个请求可能导致用户信息泄漏或者财产损失。

预防的方式只能说对请求中的参数进行验证，增加攻击者伪造请求的难度。

尽管听起来像跨站脚本（XSS），但它与 XSS 非常不同，XSS 利用站点内的信任用户，而 CSRF 则通过伪装成受信任用户的请求来 利用受信任的网站。 与 XSS 攻击相比，CSRF 攻击往往不大流行（因此对其进行防范的资源也相当稀少）和难以防范，所以被认为比 XSS 更具危险性。

XSS（corss site script）中文名跨站脚本攻击，攻击原理是原本需要接受数据但是一段脚本放置在了数据中，该脚本可能会：

1. 修改DOM,伪造页面，欺骗用户，获取账号密码等私密信息;
2. 在内面内生成浮窗广告;
3. 可以监听用户的行为,比如addEventListener('keydown') // 监听用户的键盘敲击事件
4. 窃取cookie信息
5. 获取页面数据等

预防方式：

1. 在服务端将script标签转义掉,( `服务器对输入的脚本进行过滤或转码`);
2. 充分使用 `CSP` (限制加载其他域下的资源文件、禁止向第三方提交数据)
3. cookie设置 - HttpOnly (设置这个属性之后`cookie`无法通过js去document.*cookie*读取)

### 区别

XSS攻击和CSRF攻击是两种常见的浏览器攻击方式，它们的区别如下：

- [XSS攻击是指攻击者在网页中注入恶意的脚本代码，当用户浏览这个网页时，脚本代码会被执行，从而导致用户的信息泄露或者被控制](https://www.cnblogs.com/simon7s/p/12421262.html)[1](https://www.cnblogs.com/simon7s/p/12421262.html)[2](https://www.jianshu.com/p/d170e3fa1bb2)[3](https://blog.csdn.net/guoqiankunmiss/article/details/116698367)[4](https://www.jianshu.com/p/01d60c6828d3)[。XSS攻击的目标是用户的浏览器，它不需要用户的身份认证或者Cookie信息](https://blog.csdn.net/guoqiankunmiss/article/details/116698367)[3](https://blog.csdn.net/guoqiankunmiss/article/details/116698367)。
- [CSRF攻击是指攻击者利用用户的Cookie信息，伪造用户的请求发送到服务器，从而执行一些非法的操作](https://www.cnblogs.com/simon7s/p/12421262.html)[1](https://www.cnblogs.com/simon7s/p/12421262.html)[2](https://www.jianshu.com/p/d170e3fa1bb2)[3](https://blog.csdn.net/guoqiankunmiss/article/details/116698367)[5](https://blog.csdn.net/weixin_42615105/article/details/108303684)[。CSRF攻击的目标是服务器，它需要用户的身份认证或者Cookie信息](https://blog.csdn.net/guoqiankunmiss/article/details/116698367)[3](https://blog.csdn.net/guoqiankunmiss/article/details/116698367)。
- [XSS攻击和CSRF攻击的共同点是，它们都需要诱导用户访问一个恶意的网页或者链接，从而触发攻击](https://www.cnblogs.com/simon7s/p/12421262.html)[1](https://www.cnblogs.com/simon7s/p/12421262.html)[2](https://www.jianshu.com/p/d170e3fa1bb2)[3](https://blog.csdn.net/guoqiankunmiss/article/details/116698367)[5](https://blog.csdn.net/weixin_42615105/article/details/108303684)[4](https://www.jianshu.com/p/01d60c6828d3)。

XSS可以通过脚本主动获取网站上的cookie，local Storage以及输入的信息。

CSRF是利用浏览器自动添加cookie的特点，在目标网站未关闭的情况下，恶意网站伪造了一个恶意请求。

---

## 防止cookie被篡改

服务器为每个cookie生成签名。

---

## TOKEN

jwt的全程是json web token，在开发应用时可以用它来生成用户token，他使用json对象表示信息。

JWT由三段信息构造，不同段之间用`.`号连接，第一部分称为头部，第二部分是称为载荷，第三部分是签名，签名有前面两部分计算得到，避免信息被篡改。

JWT需要我们主动提供一个密钥进行加密解密，这个密钥不能泄漏。

在我们的项目中，使用的是对称加密算法`HS256`，只需要一个密钥。

头部和载荷的原始数据都是json对象，在js的JWA库中，会对这个对象进行stringfy操作，JWT对他们进行base64url（讲base64中用到的+ / =字符替换了）编码。头部和载荷是源数据经过base64url编码后的结果，签名是使用指定对算，用密钥对头部、载荷进行加密的结果。签名可以保证信息不被篡改。

JWT的缺点是：1.token一经签名，在不使用其他技术的条件下，无法提前撤销。2.token不包含权限控制，因为token的内容需要在后端进行解密。

---

