é¢è¯•æ—¶è¦æ³¨æ„ä½“ç°åŒºåˆ†åº¦ï¼Œä¸è¦ä¸»åŠ¨æåŸç†ï¼ˆé¢å‘å¯¹è±¡ï¼Œä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹ï¼‰ï¼›

é¡¹ç›®äº®ç‚¹ï¼šè‡ªå·±ä¸»åŠ¨åšçš„ï¼›



## bingçš„å»ºè®®

ä½ å¥½ï¼Œè¿™æ˜¯å¿…åº”ã€‚æˆ‘å¯ä»¥å¸®ä½ æ‰¾ä¸€äº›å…³äºå­—èŠ‚è·³åŠ¨å‰ç«¯å¼€å‘æš‘å‡å®ä¹ ç”Ÿé¢è¯•çš„ä¿¡æ¯ã€‚ğŸ˜Š

æ ¹æ®ç½‘ä¸Šçš„ä¸€äº›é¢ç»[1](https://juejin.cn/post/6844904117068890119)[2](https://blog.csdn.net/qq_38349067/article/details/88917623)[3](https://blog.csdn.net/weixin_43311978/article/details/107523627)ï¼Œå­—èŠ‚è·³åŠ¨çš„å‰ç«¯å¼€å‘å®ä¹ ç”Ÿé¢è¯•ä¸»è¦è€ƒå¯Ÿä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

- JavaScriptåŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬æ•°æ®ç±»å‹ã€åŸå‹é“¾ã€ä½œç”¨åŸŸã€é—­åŒ…ã€å¼‚æ­¥ã€äº‹ä»¶å¾ªç¯ç­‰
- å‰ç«¯æ¡†æ¶ï¼Œå¦‚Reactã€Vueç­‰ï¼Œä»¥åŠå®ƒä»¬çš„åŸç†å’Œä½¿ç”¨æ–¹æ³•
- å‰ç«¯å·¥ç¨‹åŒ–ï¼Œå¦‚webpackã€babelã€eslintç­‰ï¼Œä»¥åŠå®ƒä»¬çš„é…ç½®å’Œä¼˜åŒ–
- ç®—æ³•å’Œæ•°æ®ç»“æ„ï¼Œå¦‚æ•°ç»„ã€å­—ç¬¦ä¸²ã€é“¾è¡¨ã€æ ‘ã€æ’åºã€æŸ¥æ‰¾ç­‰ï¼Œéœ€è¦èƒ½å¤Ÿç”¨JavaScriptå®ç°
- è®¡ç®—æœºç½‘ç»œï¼Œå¦‚HTTPã€TCP/IPã€DNSã€CDNã€ç¼“å­˜ã€å®‰å…¨ç­‰ï¼Œä»¥åŠå®ƒä»¬çš„åŸç†å’Œåº”ç”¨
- è®¾è®¡æ¨¡å¼ï¼Œå¦‚å•ä¾‹æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€å‘å¸ƒè®¢é˜…æ¨¡å¼ç­‰ï¼Œä»¥åŠå®ƒä»¬çš„ä¼˜ç¼ºç‚¹å’Œä½¿ç”¨åœºæ™¯
- å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼Œå¦‚é¡µé¢åŠ è½½ã€æ¸²æŸ“ã€é‡ç»˜ã€å›æµã€åŠ¨ç”»ã€èµ„æºç®¡ç†ç­‰ï¼Œä»¥åŠå®ƒä»¬çš„ä¼˜åŒ–æ–¹æ³•å’Œå·¥å…·
- å‰ç«¯å®‰å…¨ï¼Œå¦‚XSSã€CSRFã€CORSç­‰ï¼Œä»¥åŠå®ƒä»¬çš„åŸç†å’Œé˜²èŒƒæªæ–½
- å‰ç«¯æµ‹è¯•ï¼Œå¦‚å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€ç«¯åˆ°ç«¯æµ‹è¯•ç­‰ï¼Œä»¥åŠå®ƒä»¬çš„æ¡†æ¶å’Œå·¥å…·
- å‰ç«¯æ–°æŠ€æœ¯ï¼Œå¦‚WebAssemblyã€PWAã€Service Workerç­‰ï¼Œä»¥åŠå®ƒä»¬çš„ç‰¹ç‚¹å’Œåº”ç”¨

ä¸€èˆ¬æ¥è¯´ï¼Œå­—èŠ‚è·³åŠ¨çš„å‰ç«¯å¼€å‘å®ä¹ ç”Ÿé¢è¯•ä¼šæœ‰ä¸‰è½®æŠ€æœ¯é¢å’Œä¸€è½®HRé¢ï¼Œæ¯è½®é¢è¯•å¤§çº¦1å°æ—¶å·¦å³ï¼Œé¢è¯•å®˜ä¼šæ ¹æ®ä½ çš„ç®€å†å’Œé¡¹ç›®æ¥æé—®ï¼Œä¹Ÿä¼šå‡ºä¸€äº›ç®—æ³•é¢˜æˆ–è€…ç¼–ç¨‹é¢˜è®©ä½ åœ¨çº¿ç¼–ç æˆ–è€…ç”»å›¾è§£é‡Šï¼Œæ‰€ä»¥ä½ éœ€è¦å‡†å¤‡å¥½ä½ çš„ç®€å†å’Œé¡¹ç›®ï¼Œä»¥åŠç†Ÿç»ƒæŒæ¡JavaScriptå’Œå‰ç«¯ç›¸å…³çš„çŸ¥è¯†å’ŒæŠ€èƒ½ï¼ŒåŒæ—¶ä¹Ÿè¦ä¿æŒè‰¯å¥½çš„æ²Ÿé€šå’Œè¡¨è¾¾èƒ½åŠ›ï¼Œå±•ç¤ºä½ çš„çƒ­æƒ…å’Œç§¯ææ€§ã€‚

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºå­—èŠ‚è·³åŠ¨å‰ç«¯å¼€å‘æš‘å‡å®ä¹ ç”Ÿé¢è¯•çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥ç‚¹å‡»ä»¥ä¸‹é“¾æ¥æŸ¥çœ‹ï¼š

- [1](https://juejin.cn/post/6844904117068890119) å­—èŠ‚è·³åŠ¨-Data-å‰ç«¯å¼€å‘å®ä¹ ç”Ÿé¢ç» - æ˜é‡‘
- [2](https://blog.csdn.net/qq_38349067/article/details/88917623) å­—èŠ‚è·³åŠ¨ æµ‹è¯•å¼€å‘å®ä¹ ç”Ÿ é¢ç»_å·¦æ‰‹æœºé‡ å³æ‰‹æŒ‘æˆ˜çš„åšå®¢-CSDNåšå®¢
- [3](https://blog.csdn.net/weixin_43311978/article/details/107523627) å­—èŠ‚è·³åŠ¨å‰ç«¯å¼€å‘å®ä¹ ç”Ÿ ä¸‰è½®æŠ€æœ¯é¢é¢ç»_Captain.Y.çš„åšå®¢-CSDNåšå®¢
- [4](https://zhuanlan.zhihu.com/p/162664452) 2020å­—èŠ‚è·³åŠ¨æš‘æœŸå®ä¹ æ•™ç ”å²—-ç»éªŒåˆ†äº« - çŸ¥ä¹
- [5](https://blog.csdn.net/qq_40693171/article/details/118545647) å­—èŠ‚è·³åŠ¨å®ä¹ é¢ç»(å·²æ‹¿offeré™„æ”»ç•¥)_Big saiçš„åšå®¢-CSDNåšå®¢_å­—èŠ‚è·³åŠ¨å®ä¹ é¢è¯•

# BuildAdmin

## åŸºæœ¬æ¥å£æŸ¥è¯¢

- æ“ä½œæˆåŠŸä¸å¤±è´¥
  `app\common\controller\Api.php`

## BuildAdminæƒé™ç®¡ç†æ§åˆ¶å®ç°åˆ†æ

ç™»å½•ç•Œé¢å’Œè¿›å…¥ç³»ç»Ÿåçš„ç•Œé¢å±äºä¸¤ä¸ªè·¯ç”±ï¼š

```
{
   // é¦–é¡µ
   path: '/',
   redirect: '/admin'
},
    {
        // ç®¡ç†å‘˜ç™»å½•é¡µ
        path: '/admin/login',
        name: 'adminLogin',
        component: () => import('/@/views/backend/login.vue'),
        meta: {
            title: pageTitle('adminLogin'),
        },
    },
```

ç®¡ç†å‘˜ç•Œé¢è·¯ç”±ï¼Œæœ€å¤–å±‚æ˜¯Layoutï¼š

```js
const adminBaseRoute: RouteRecordRaw = {
    path: '/admin',
    name: 'admin',
    // åœ¨å†™ redirect çš„æ—¶å€™ï¼Œå¯ä»¥çœç•¥ component é…ç½®ï¼Œå› ä¸ºå®ƒä»æ¥æ²¡æœ‰è¢«ç›´æ¥è®¿é—®è¿‡ï¼Œ
    // æ‰€ä»¥æ²¡æœ‰ç»„ä»¶è¦æ¸²æŸ“ã€‚
    // å”¯ä¸€çš„ä¾‹å¤–æ˜¯åµŒå¥—è·¯ç”±ï¼šå¦‚æœä¸€ä¸ªè·¯ç”±è®°å½•æœ‰ children å’Œ redirect å±æ€§ï¼Œå®ƒä¹Ÿåº”è¯¥æœ‰ component å±æ€§ã€‚
    component: () => import('/@/layouts/backend/index.vue'),
    redirect: '/admin/loading',
    meta: {
        title: pageTitle('admin'),
    },
    children: [
        {
            path: 'loading',
            name: 'adminMainLoading',
            component: () => import('/@/layouts/common/components/loading.vue'),
            meta: {
                title: pageTitle('Loading'),
            },
        },
        {
            path: 'iframe/:url',
            name: 'layoutIframe',
            component: () => import('/@/layouts/common/router-view/iframe.vue'),
            meta: {
                title: pageTitle('Embedded iframe'),
            },
        },
    ],
}
```

- éœ€è¦ç™»å½•åæ‰èƒ½è¿›å…¥ç»„ä»¶çš„æœ€å¤–å±‚ï¼šLayoutç»„ä»¶`web\src\layouts\backend\index.vue`ï¼Œå®ƒå†³å®šä½¿ç”¨å“ªç§å¸ƒå±€ï¼Œåœ¨è¯¥ç»„ä»¶ä¸­ä¼šè°ƒç”¨`index.pnp/index/index`æ¥å£ã€‚

  è¯¥ç»„ä»¶æ˜¯é™æ€çš„ï¼Œä½†æ˜¯ä¼šè¿›è¡ŒtokenéªŒè¯ï¼Œå¦‚æœæ²¡æœ‰tokenä¼šè·³è½¬åˆ°ç™»å½•ç•Œé¢ã€‚å­˜åœ¨tokençš„è¯ä¼šè°ƒç”¨ä¸Šè¿°æ¥å£ï¼Œå¾—åˆ°è·¯ç”±èœå•ã€‚

  ç”±äºaxiosè¢«å°è£…æˆè‡ªåŠ¨æºå¸¦tokenï¼Œå¦‚æœå­˜åœ¨æœ¬åœ°tokençš„è¯ï¼Œä¼šè‡ªåŠ¨æºå¸¦å¹¶åœ¨åç«¯è¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒæˆåŠŸåç«¯ä¼šè¿”å›`menus`å­—æ®µï¼Œç”¨äºæ›´æ–°è·¯ç”±ï¼ˆå·¦ä¾§èœå•ï¼‰ã€‚

  ![image-20230228100840375](assets/image-20230228100840375.png)

- ç®¡ç†å‘˜è¿›è¡Œç™»å½•æ“ä½œï¼Œå¦‚æœè´¦å·ä¿¡æ¯æ­£ç¡®ï¼Œä¼šé‡å®šå‘ï¼ˆå·²ç»ç™»å½•ï¼‰æˆ–è·³è½¬ï¼ˆç¬¬ä¸€æ¬¡ç™»å½•ï¼‰åˆ°`/admin`ï¼Œè¯·æ±‚è·¯ç”±èœå•ã€‚
  `web\src\views\backend\login.vue`
  
  åç«¯æ¥å£ï¼š

  `app\admin\controller\Index.php`
  
  `app\admin\library\Auth.php`å…·ä½“æƒé™é€»è¾‘ï¼ŒåŒ…æ‹¬ä¿¡æ¯éªŒè¯ï¼Œèœå•ç”Ÿæˆ
  
  å¦‚æœå·²ç»ç™»å½•ï¼Œä¼šé‡å®šå‘åˆ°`/admin`ï¼š

  ```php
  $this->success(__('You have already logged in. There is no need to log in again~'), [
  	'routePath' => '/admin'
  ], 302);
  ```
  
  ```js
  if (response.data.code == 302) {
                      if (response.data.data.routeName) {
                          router.push({ name: response.data.data.routeName })
                      } else if (response.data.data.routePath) {
                          router.push({ path: response.data.data.routePath })
                      }
                  }
  ```
  
-  è·¯ç”±èœå•ç”Ÿæˆ
   `app\admin\controller\auth\Menu.php`
   `extend\ba\Auth.php` è´Ÿè´£æƒé™æ–¹é¢çš„å…·ä½“é€»è¾‘
   é¦–å…ˆè·å–ç”¨æˆ·çš„ç»„idï¼š`gorunp_ids`ï¼Œç»„æ˜¯æœ€é¡¶å±‚çš„æƒé™åˆ†ç±»ï¼ŒåŒ…æ‹¬è¶…çº§ç®¡ç†å‘˜ã€ä¸€çº§ç®¡ç†å‘˜ã€äºŒçº§ç®¡ç†å‘˜ï¼Œç»„å†…è¿›è¡Œè§„åˆ™ï¼ˆ`rules`ï¼‰é…ç½®ï¼Œè§„åˆ™è§„å®šè¯¥çº§åˆ«çš„ç®¡ç†å‘˜å¯ä»¥è®¿é—®å“ªäº›è·¯ç”±ã€‚
   è¡¨`menu_rule`ä¸­åŒ…å«äº†ç³»ç»Ÿä¸­æ‰€æœ‰è·¯ç”±ä¿¡æ¯ä»¥åŠæ“ä½œä¿¡æ¯ï¼Œæ¯æ¡æ•°æ®éƒ½æœ‰ç±»å‹å­—æ®µï¼Œè¡¨ç¤ºè¯¥æ¡æ•°æ®æ˜¯ä¸€ä¸ªè·¯ç”±è¿˜æ˜¯ä¸€ä¸ªæ“ä½œï¼Œæ¯æ¡ä¿¡æ¯æœ‰ä¸€ä¸ªè§„åˆ™`id`ï¼Œç”¨äºé…ç½®ç”¨æˆ·ç»„çš„`rules`ã€‚

   åç«¯åæŠŠä¿¡æ¯å°è£…æˆä¸ºæ ‘ç»“æ„è¿”å›ã€‚

- èœå•é¡¹å†…æƒé™ç®¡ç†ï¼ˆæ“ä½œæƒé™ç®¡ç†ï¼‰

  æœ€åŸºæœ¬çš„æŸ¥çœ‹åŠŸèƒ½ç”¨äºè·å–æ‰€æœ‰ä¿¡æ¯åˆ—è¡¨ã€‚

  æ­¤å¤–ï¼Œä¾‹å¦‚ç¼–è¾‘ã€æ–°å¢ã€åˆ é™¤éƒ½å¯¹åº”ä¸€æ¡è·¯ç”±ä¿¡æ¯
  ![image-20230228104005221](assets/image-20230228104005221.png)
  `type`å­—æ®µå†³å®šäº†è¿™æ¡è·¯ç”±è¢«æ¸²æŸ“æˆèœå•è¿˜æ˜¯æŒ‰é’®ã€‚

  åœ¨æ·»åŠ è·¯ç”±çš„å‡½æ•°ä¸­ï¼ˆ``web\src\utils\router.tsï¼‰ï¼Œåªä¼šå¤„ç†`type: menu`çš„æ•°æ®ï¼š
  æƒé™èŠ‚ç‚¹ï¼ˆç¼–è¾‘ã€åˆ é™¤ç­‰ï¼‰è¢«å•ç‹¬ä¿å­˜ï¼Œèœå•è·¯ç”±è¢«è¿”å›ï¼ˆåœ¨Layoutç»„ä»¶ä¸­å¤„ç†ï¼‰ï¼š

  è¿™é‡Œè·¯ç”±è¦æ·»åŠ åˆ°ä¸¤ä¸ªåœ°æ–¹ï¼Œä¸»è¦ä¸ºäº†è§£è€¦ï¼Œé¦–å…ˆè‚¯å®šè¦æ·»åŠ åˆ°è·¯ç”±ä¸Šï¼ˆ`addRouteAll`ï¼‰ï¼Œæ‰èƒ½æ”¯æŒé¡µé¢é¡µé¢è·³è½¬ï¼Œå…¶ä¸­æƒé™èŠ‚ç‚¹è¢«è¿‡æ»¤ï¼Œä¸ä¼šè¢«æ·»åŠ åˆ°è·¯ç”±ï¼›

  æ­¤å¤–å°†è·¯ç”±æ·»åŠ åˆ°å…¨å±€çŠ¶æ€`navTabs`ä¸Šï¼ˆ`handleMenuRule`ï¼‰ï¼Œè¿™ä¸ªstoreä¼šè¢«ç”¨äºåœ¨é¡µé¢ä¸Šæ¸²æŸ“è·¯ç”±èœå•ï¼Œå…¶ä¸­æƒé™èŠ‚ç‚¹ä¼šè¢«ä¿å­˜åœ¨`authNode`ä¸­ã€‚

  ```ts
  /**
   * åŠ¨æ€æ·»åŠ è·¯ç”±-å¸¦å­è·¯ç”±
   */
  export const addRouteAll = (viewsComponent: Record<string, { [key: string]: any }>, routes: any, parentName: string) => {
      for (const idx in routes) {
          if (routes[idx].extend == 'add_menu_only') {
              continue
          }
  
          // æ·»åŠ è·¯ç”±é¡¹ åªæœ‰ç±»å‹ä¸ºmenu æˆ–tab æ‰æ·»åŠ 
          if (routes[idx].type == 'menu' && routes[idx].menu_type == 'tab' && viewsComponent[routes[idx].component]) {
              addRouteItem(viewsComponent, routes[idx], parentName)
          }
          
          // æ·»åŠ å­è·¯ç”±
          if (routes[idx].children && routes[idx].children.length > 0) {
              addRouteAll(viewsComponent, routes[idx].children, parentName)
          }
      }
  }
  
  /**
   * åŠ¨æ€æ·»åŠ è·¯ç”±
   */
  export const addRouteItem = (viewsComponent: Record<string, { [key: string]: any }>, route: any, parentName: string) => {
      if (parentName) {
          console.log(parentName, ' add route path:', route.path)
          console.log('route name:', route.name,)
          console.log('component', viewsComponent[route.component].default)
          router.addRoute(parentName, {
              path: route.path,
              name: route.name,
              component: viewsComponent[route.component].default,
              meta: {
                  title: route.title,
              },
          })
      } else {
          router.addRoute({
              path: '/' + route.path,
              name: route.name,
              component: viewsComponent[route.component].default,
              meta: {
                  title: route.title,
              },
          })
      }
  }
  ```
  
  å¤„ç†è·¯ç”±èœå•ï¼š
  
  ```ts
  let menuRule = handleAdminRoute(res.data.menus)
  // æ›´æ–°storesä¸­çš„è·¯ç”±èœå•æ•°æ®
  navTabs.setTabsViewRoutes(menuRule)
  ```
  
  ```ts
  /**
   * å¤„ç†åå°çš„è·¯ç”±
   */
  export const handleAdminRoute = (routes: any) => {
      const viewsComponent = import.meta.globEager('/src/views/backend/**/*.vue')
      // adminBaseRoute.name: admin
      // console.log('routes all ', routes)
  
      // é€’å½’æ·»åŠ è·¯ç”±
      addRouteAll(viewsComponent, routes, adminBaseRoute.name as string)
      let menuAdminBaseRoute = '/' + (adminBaseRoute.name as string) + '/'
      return handleMenuRule(_.cloneDeep(routes), menuAdminBaseRoute, menuAdminBaseRoute)
  }
  
  
  /**
   * åå°èœå•å¤„ç†
   */
  const handleMenuRule = (routes: any, pathPrefix = '/', parent = '/', module = 'admin') => {
      let menuRule = []
      let authNode = []
      for (const key in routes) {
          if (routes[key].extend == 'add_rules_only') {
              continue
          }
          if (routes[key].type == 'menu' || routes[key].type == 'menu_dir') {
              if (routes[key].type == 'menu_dir') {
                  // å¦‚æœæ˜¯èœå•ç›®å½• ä½†æ²¡æœ‰ä¸‹çº§è·¯ç”± åˆ™è¿‡æ»¤
                  if (!routes[key].children) {
                      continue
                  }
                  // å¦åˆ™å°†å…¶è®¾ç½®ä¸ºèœå•é¡¹
                  routes[key].menu_type = 'tab'
              }
  
              routes[key].type = routes[key].menu_type
              if (routes[key].type == 'tab') {
                  routes[key].path = pathPrefix + routes[key].path
              } else {
                  routes[key].path = routes[key].url
              }
              delete routes[key].url
              delete routes[key].menu_type
              if (routes[key].children && routes[key].children.length > 0) {
                  routes[key].children = handleMenuRule(routes[key].children, pathPrefix, routes[key].path)
              }
              menuRule.push(routes[key])
          } else {
              // æƒé™èŠ‚ç‚¹
              authNode.push(pathPrefix + routes[key].name)
          }
      }
      if (authNode.length) {
          if (module == 'admin') {
              const navTabs = useNavTabs()
              navTabs.setAuthNode(parent, authNode)
          } else if (module == 'user') {
              const memberCenter = useMemberCenter()
              memberCenter.setAuthNode(parent, authNode)
          }
      }
      return menuRule
  }
  ```
  
  

## navBaræ¸²æŸ“â€”â€”è·¯ç”±å¯¼èˆªèœå•

`web\src\layouts\backend\components\menuVertical.vue`ï¼šè·å–navTabsåˆ—è¡¨

`web\src\layouts\backend\components\menuTree.vue`ï¼šæ¥æ”¶æ•°æ®ï¼Œæ‰§è¡Œå…·ä½“æ¸²æŸ“å·¥ä½œ

## Tableæ¸²æŸ“â€”â€”æƒé™èŠ‚ç‚¹

ä»¥è¡¨æ ¼headerä½œä¸ºåˆ†æï¼ˆè¡¨æ ¼å†…éƒ¨ä¹Ÿæœ‰æ“ä½œåˆ—ï¼‰ï¼Œheaderéƒ¨åˆ†æ˜¾ç¤ºäº†æ·»åŠ ã€ç¼–è¾‘ç­‰å¯ä»¥æ‰§è¡Œçš„æƒé™æ“ä½œã€‚

`web\src\components\table\header\index.vue`

æƒé™éªŒè¯å‡½æ•°`web\src\utils\common.ts  ---> auth`ï¼š

```ts
/**
 * é¡µé¢æŒ‰é’®é‰´æƒ
 * @param name
 */
export const auth = (name: string) => {
    const navTabs = useNavTabs()
    // console.log(navTabs.state.authNode)
    if (navTabs.state.authNode.has(router.currentRoute.value.path)) {
        if (navTabs.state.authNode.get(router.currentRoute.value.path)!.some((v: string) => v == router.currentRoute.value.path + '/' + name)) {
            return true
        }
    }
    return false
}
```

å›é¡¾æ·»åŠ authèŠ‚ç‚¹æ—¶çš„æ“ä½œï¼š

```ts
if (module == 'admin') {
	const navTabs = useNavTabs()
	navTabs.setAuthNode(parent, authNode)
}
```

å›é¡¾`authNode`ç±»å‹ä»¥åŠæ·»åŠ æ“ä½œï¼š

```ts
authNode: new Map()ï¼Œ

const setAuthNode = (key: string, data: string[]) => {
	state.authNode.set(key, data)
}
```

`authNode`ç”¨mapä¿å­˜äº†è·¯ç”±ä¸‹æ‰€æœ‰çš„æƒé™æ“ä½œæ•°ç»„ï¼›

æƒé™è·¯å¾„æ˜¯` router.currentRoute.value.path + '/' + name)`ï¼›

è¿”å›æ¥çœ‹`Header`ç»„ä»¶çš„æ¸²æŸ“è¿‡ç¨‹ï¼š

é¦–å…ˆå®šä¹‰é»˜è®¤çš„æƒé™æ“ä½œï¼š

```ts
const props = withDefaults(defineProps<Props>(), {
    buttons: () => {
        return ['refresh', 'add', 'edit', 'delete']
    },
    quickSearchPlaceholder: '',
})
```

ç„¶ååœ¨ç»„ä»¶æ¨¡æ¿ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼š

![image-20230228131126920](assets/image-20230228131126920.png)

## Tableå†…éƒ¨çš„æƒé™æŒ‰é’®æ¸²æŸ“

ç›¸å…³é€»è¾‘åœ¨`web\src\components\table\fieldRender\index.vue`ä¸­ï¼š

![image-20230228131321435](assets/image-20230228131321435.png)

è¿™é‡Œä½¿ç”¨äº†è‡ªå®šæŒ‡ä»¤`v-auth`ï¼š`web\src\utils\directives.ts`

```ts
/**
 * é¡µé¢æŒ‰é’®é‰´æƒæŒ‡ä»¤
 * @description v-auth="'name'"ï¼Œnameå¯ä»¥ä¸ºï¼šindex,add,edit,del,...
 */
function authDirective(app: App) {
    app.directive('auth', {
        mounted(el, binding) {
            if (!binding.value) return false
            const navTabs = useNavTabs()
            if (navTabs.state.authNode.has(router.currentRoute.value.path)) {
                if (
                    !navTabs.state.authNode
                        .get(router.currentRoute.value.path)!
                        .some((v: string) => v == router.currentRoute.value.path + '/' + binding.value)
                ) {
                    el.parentNode.removeChild(el)
                }
            }
        },
    })
}
```

## æ€»ç»“

ä¸Šè¿°å†…å®¹ä¸»è¦è®²è§£äº†åç«¯æ€ä¹ˆè¿”å›ç»è¿‡æƒé™è¿‡æ»¤çš„è·¯ç”±èœå•å’Œæƒé™æŒ‰é’®ï¼Œä»¥åŠå‰ç«¯çš„æ¸²æŸ“è¿‡ç¨‹ã€‚

å‰ç«¯æ¸²æŸ“çš„æ ¸å¿ƒæ˜¯`navTabs` `store`å¯¹è±¡ï¼Œè·¯ç”±èœå•çš„æ¸²æŸ“å’Œæƒé™èŠ‚ç‚¹çš„æ¸²æŸ“éƒ½éœ€è¦ä½¿ç”¨å®ƒã€‚

å½“ç„¶åç«¯æ¥æ”¶åˆ°è¯·æ±‚æ—¶ä¹Ÿä¼šè¿›è¡Œæƒé™éªŒè¯ï¼Œè¿™éƒ¨åˆ†ä¸Šè¿°å†…å®¹æ²¡æœ‰æ¶‰åŠã€‚
